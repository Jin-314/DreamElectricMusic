
# Ele Mag Payer

自作電磁演奏楽器「Ele Mag Harmony」を再生させるプレイヤー、その名もEle Mag Playerです！

![Ele Mag Player 2023_04_05 22_51_26](https://user-images.githubusercontent.com/58265068/230101162-90cf6bc3-d8e8-4398-9058-ee8850e10c6d.png)

# Requirement

windowsのみ対応

推奨はwindows10以上

# Installation

リリースより最新版のセットアップファイルをダウンロードし、インストールします。

# Useage

基本的にはEleaMagHarmony演奏用ですが、midiプレイヤーとして音源を再生することも可能です。4chのみ同時に演奏できます。

## デバイスの接続

Ele Mag Harmonyを演奏させる場合、デバイスのCOMポートとボーレートを指定してシリアル通信（UART）で接続させる必要があります。

## 音源の準備

再生させたい音源を、DLしたり自ら作成する必要があります。

## チャネルの設定

デフォルトのmidiチャネルとパートの設定は、

- ch1 : メロディ（StpMotor）
- ch4 : ギター（Solenoid）
- ch3 : ベース（FDD）
- ch9 : ドラム（Relay）

このようになっています。各パートに鳴らせたいchは自由に変更することが可能です。

## プレイヤー機能

プレイヤーには音楽を再生する基本的な機能が備わっております。再生するにはまず。midi音源を選択する必要があります。ファイル(F) -> midiファイルを開く(M) を選択して音源を選択してください。

### 再生

![play](EMH_Player/IMG/play_icon.png)

再生ボタンを押すと再生が開始されます。デフォルトではPCから音が再生されます。一度再生ボタンを押すと、再生ボタンが一時停止ボタンに置き換わります。

EleMag楽器からの音を再生する場合は、設定(S) -> シリアルポート(E)...を選択し、DriverのCOMポートを指定し、ボーレート（デフォルトでは345600）を選択して接続してください。

楽器からの再生ではPCの音とずれが発生しますので、muteのチェックボックスをチェックしてPCからの音をオフにすることをお勧めします。

### 一時停止/停止

![pause](EMH_Player/IMG/pause_icon.png)
![stop](EMH_Player/IMG/stop_icon.png)

再生中に再生ボタンが一時停止ボタンに変わります。停止ボタンは再生ボタン/一時停止ボタンの横にあります。停止ボタンの場合は曲がリセットされ、最初からの再生となります。

再生中はメニューの操作ができないため、もし設定をする必要がある場合は一時停止又は停止後に再度設定してください。

### 曲戻し/曲送り

![return](EMH_Player/IMG/return_icon.png)
![next](EMH_Player/IMG/next_icon.png)

スキップのボタンを押すと、プレイリストファイルでの再生（詳細後述）の場合は次の曲が再生されます。リターンの場合はその逆で、前の曲が再生されます。

midiファイル単体の場合は両方ともリピートモードでなければ再生が停止され、リピートモードの場合は曲の初めに戻ります。

### プレイリスト

.m3uのプレイリストファイルでプレイリスト化して再生することができます。

プレイリストファイルは、テキストで音源ファイル(midi)までの絶対パスを記述し、拡張子をm3uにするだけで作成可能です。

### リピート/ランダム

![repeat](EMH_Player/IMG/repeat_icon_enable.png)
![random](EMH_Player/IMG/random_icon_enable.png)

一曲の再生モードであれば、ランダム機能は無効です。リピート機能はその一曲のみをリピートさせます。
プレイリストの再生モードであれば、プレイリストに書かれている順番に限らず、ランダムに再生します。リピート機能はプレイリスト全体をリピートします。
